\pgfkeys{
/bilinear/.is family, /bilinear,
default/.style={
startx = 0cm,
starty = 0cm,
yield displacement = 1cm,
yield force = 2cm,
maximum displacement = 2cm,
maximum force = 3cm,
axis space = 1cm,
mode = 1,
x-axis label = {Disp., $(d)$},
y-axis label = {Force, $(f)$},
kp text = $k_\textrm{p}$,
ks text = $k_\textrm{s}$,
fy text = $f_\textrm{y}$,
dy text = $d_\textrm{y}$,
mark yield point = 1,
fmax text = $f_\textrm{m}$,
dmax text = $d_\textrm{m}$,
mark max point = 1,
},
startx/.store in = \startx,
starty/.store in = \starty,
yield displacement/.store in = \dy,
yield force/.store in = \fy,
maximum displacement/.store in = \dm,
maximum force/.store in = \fm,
axis space/.store in = \axsp,
mode/.store in = \mode,
x-axis label/.store in = \xlab,
y-axis label/.store in = \ylab,
kp text/.store in = \kpt,
ks text/.store in = \kst,
fy text/.store in = \fyt,
dy text/.store in = \dyt,
mark yield point/.store in = \myp,
fmax text/.store in = \fmt,
dmax text/.store in = \dmt,
mark max point/.store in = \mmp,
}
\newcommand{\bilinear}[1][]{
\pgfkeys{/bilinear, default, #1}
\tikzmath{
real \startx, \starty;
real \dy, \fy, \dm, \fm, \axsp;
integer \mode;
%Conversion all units to the unit pt
\dy = \dy;
\fy = \fy;
\dm = \dm;
\fm = \fm;
\axsp = \axsp;
%End conversion, All values are now in pt units
\xmax = \dm + \axsp;
\ymax = \fm + \axsp;
\pyd = \dm - \dy;   %Post yield displacement
\pyf = \fm - \fy;   %Post yield force
}
\begin{scope}[x=1pt, y=1pt, xshift = \startx, yshift=\starty, rotate=0];    % Draw everything in pt units

\ifthenelse{\myp=1}{
\draw [very thin, dashed] (\dy, 0)--node[at start, below=-1]{\dyt}(\dy, \fy);
\draw [very thin, dashed] (0, \fy)--node[at start, left=-2, yshift=0.1cm]{\fyt}(\dy, \fy);
}{}

\ifthenelse{\mmp=1}{
\draw [very thin, dashed] (\dm, 0)--node[at start, below=-1]{\dmt}(\dm, \fm);
\draw [very thin, dashed] (0, \fm)--node[at start, left=-2]{\fmt}(\dm, \fm);
}{}

\ifthenelse{\mode=1}{
\draw [thin, <->] (-\axsp,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,-\axsp) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}]
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm);
}{}

\ifthenelse{\mode=2}{
\draw [thin, <->] (-\axsp,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,-\axsp) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}]
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-\dy, -\fy);
}{}


\ifthenelse{\mode=3}{
\draw [thin, <->] (-\axsp,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,\fm - 2*\fy - \axsp) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}]
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-2*\dy, -2*\fy);
}{}

\ifthenelse{\mode=4}{
\draw [thin, <->] (\dm- 2*\dy -\pyd -\axsp,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,\fm -2*\fy -\pyf -\axsp) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}] 
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-2*\dy, -2*\fy)
-- node[above, midway]{\kst}++(-\pyd, -\pyf);
}{}


\ifthenelse{\mode=5}{
\draw [thin, <->] (-\xmax,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,-\ymax) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}] 
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-2*\dy, -2*\fy)
-- node[above, midway]{\kst}++(-2*\pyd, -2*\pyf);
}{}

\ifthenelse{\mode=6}{
\draw [thin, <->] (-\xmax,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,-\ymax) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}] 
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-2*\dy, -2*\fy)
-- node[above, midway]{\kst}++(-2*\pyd, -2*\pyf)
-- node[right, midway]{\kpt}++(\dy, \fy);
}{}

\ifthenelse{\mode=7}{
\draw [thin, <->] (-\xmax,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,-\ymax) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}] 
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-2*\dy, -2*\fy)
-- node[above, midway]{\kst}++(-2*\pyd, -2*\pyf)
-- node[right, midway]{\kpt}++(2*\dy, 2*\fy);
}{}

\ifthenelse{\mode=8}{
\draw [thin, <->] (-\xmax,0) -- node[at end, below]{\xlab}(\xmax,0);
\draw [thin, <->] (0,-\ymax) -- node[at end, left]{\ylab}(0,\ymax);
\path [thick, draw=black, postaction={on each segment={mid arrow=black}}] 
(0,0)
-- node[right, midway, behind path, fill=white]{\kpt}(\dy,\fy)
-- node[below, midway]{\kst}(\dm,\fm)
-- node[left, midway]{\kpt}++(-2*\dy, -2*\fy)
-- node[above, midway]{\kst}++(-2*\pyd, -2*\pyf)
-- node[right, midway]{\kpt}++(2*\dy, 2*\fy)
-- node[below, midway]{\kst}++(\pyd, \pyf) ;
}{}
\end{scope}
}

